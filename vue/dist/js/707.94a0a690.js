"use strict";(self["webpackChunkspringboot_vue_project"]=self["webpackChunkspringboot_vue_project"]||[]).push([[707],{3707:function(e,a,l){l.r(a),l.d(a,{default:function(){return _}});var t=l(6252),s=l(9963);const r=(0,t.Uk)(" 查询"),o=(0,t.Uk)(" 重置"),i=(0,t.Uk)("待审核"),n=(0,t.Uk)("借阅中"),u=(0,t.Uk)("已归还"),p=(0,t.Uk)("未归还"),h=(0,t.Uk)(" 通过审核"),d=(0,t.Uk)(" 归还"),m=(0,t.Uk)(" 丢失"),c={style:{margin:"10px 0"}};function g(e,a,l,g,w,k){const f=(0,t.up)("el-input"),y=(0,t.up)("el-option"),b=(0,t.up)("el-select"),_=(0,t.up)("Search"),C=(0,t.up)("el-icon"),W=(0,t.up)("el-button"),v=(0,t.up)("RefreshLeft"),U=(0,t.up)("el-table-column"),V=(0,t.up)("el-tag"),x=(0,t.up)("EditPen"),z=(0,t.up)("Check"),j=(0,t.up)("Close"),P=(0,t.up)("el-table"),S=(0,t.up)("el-pagination");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("div",{style:{"margin-top":"10px"},onKeyup:a[5]||(a[5]=(0,s.D2)(((...e)=>k.load&&k.load(...e)),["enter","native"]))},[(0,t.Wm)(f,{modelValue:w.searchTitle,"onUpdate:modelValue":a[0]||(a[0]=e=>w.searchTitle=e),placeholder:"请输入图书名称",clearable:"",style:{width:"10%"}},null,8,["modelValue"]),"admin"===w.user.role?((0,t.wg)(),(0,t.j4)(f,{key:0,modelValue:w.searchUsername,"onUpdate:modelValue":a[1]||(a[1]=e=>w.searchUsername=e),placeholder:"请输入用户名",clearable:"",style:{width:"10%","margin-left":"5px"}},null,8,["modelValue"])):(0,t.kq)("",!0),"admin"===w.user.role?((0,t.wg)(),(0,t.j4)(f,{key:1,modelValue:w.searchPhone,"onUpdate:modelValue":a[2]||(a[2]=e=>w.searchPhone=e),placeholder:"请输入用户电话",clearable:"",style:{width:"10%","margin-left":"5px"}},null,8,["modelValue"])):(0,t.kq)("",!0),"admin"===w.user.role?((0,t.wg)(),(0,t.j4)(f,{key:2,modelValue:w.searchEmail,"onUpdate:modelValue":a[3]||(a[3]=e=>w.searchEmail=e),placeholder:"请输入用户邮箱",clearable:"",style:{width:"10%","margin-left":"5px"}},null,8,["modelValue"])):(0,t.kq)("",!0),(0,t.Wm)(b,{modelValue:w.searchState,"onUpdate:modelValue":a[4]||(a[4]=e=>w.searchState=e),options:w.options,placeholder:"请选择图书类型",clearable:"",ref:"select",style:{width:"10%","margin-left":"5px"}},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(w.options,(e=>((0,t.wg)(),(0,t.j4)(y,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","options"]),(0,t.Wm)(W,{style:{"margin-left":"5px","margin-bottom":"5px"},onClick:k.load},{default:(0,t.w5)((()=>[r,(0,t.Wm)(C,{style:{"margin-left":"5px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(_)])),_:1})])),_:1},8,["onClick"]),(0,t.Wm)(W,{style:{"margin-left":"5px","margin-bottom":"5px"},onClick:k.reset},{default:(0,t.w5)((()=>[o,(0,t.Wm)(C,{style:{"margin-left":"5px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(v)])),_:1})])),_:1},8,["onClick"])],32),(0,t._)("div",null,[(0,t.Wm)(P,{data:w.tableData,stripe:"",style:{width:"100%"},fit:""},{default:(0,t.w5)((()=>[(0,t.Wm)(U,{prop:"id",label:"借阅ID"}),(0,t.Wm)(U,{prop:"title",label:"书名"}),(0,t.Wm)(U,{prop:"username",label:"用户名"}),(0,t.Wm)(U,{prop:"phone",label:"电话"}),(0,t.Wm)(U,{prop:"email",label:"邮箱"}),(0,t.Wm)(U,{prop:"startDate",label:"借阅开始日期"}),(0,t.Wm)(U,{prop:"endDate",label:"借阅结束日期"}),(0,t.Wm)(U,{prop:"state",label:"状态"},{default:(0,t.w5)((e=>["待审核"===e.row.state?((0,t.wg)(),(0,t.j4)(V,{key:0,type:"warning"},{default:(0,t.w5)((()=>[i])),_:1})):(0,t.kq)("",!0),"借阅中"===e.row.state?((0,t.wg)(),(0,t.j4)(V,{key:1,type:"primary"},{default:(0,t.w5)((()=>[n])),_:1})):(0,t.kq)("",!0),"已归还"===e.row.state?((0,t.wg)(),(0,t.j4)(V,{key:2,type:"success"},{default:(0,t.w5)((()=>[u])),_:1})):(0,t.kq)("",!0),"未归还"===e.row.state?((0,t.wg)(),(0,t.j4)(V,{key:3,type:"danger"},{default:(0,t.w5)((()=>[p])),_:1})):(0,t.kq)("",!0)])),_:1}),"admin"===w.user.role?((0,t.wg)(),(0,t.j4)(U,{key:0,fixed:"right",label:"操作",width:"210"},{default:(0,t.w5)((e=>["待审核"===e.row.state?((0,t.wg)(),(0,t.j4)(W,{key:0,size:"small",onClick:a=>k.approve(e.row),type:"primary"},{default:(0,t.w5)((()=>[h,(0,t.Wm)(C,{style:{"margin-left":"5px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(x)])),_:1})])),_:2},1032,["onClick"])):(0,t.kq)("",!0),"借阅中"===e.row.state?((0,t.wg)(),(0,t.j4)(W,{key:1,size:"small",onClick:a=>k.finish(e.row),type:"primary"},{default:(0,t.w5)((()=>[d,(0,t.Wm)(C,{style:{"margin-left":"5px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(z)])),_:1})])),_:2},1032,["onClick"])):(0,t.kq)("",!0),"借阅中"===e.row.state?((0,t.wg)(),(0,t.j4)(W,{key:2,size:"small",onClick:a=>k.drop(e.row),type:"danger"},{default:(0,t.w5)((()=>[m,(0,t.Wm)(C,{style:{"margin-left":"5px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(j)])),_:1})])),_:2},1032,["onClick"])):(0,t.kq)("",!0)])),_:1})):(0,t.kq)("",!0)])),_:1},8,["data"]),(0,t._)("div",c,[(0,t.Wm)(S,{onSizeChange:k.sizeChange,onCurrentChange:k.currentChange,currentPage:w.currentPage,"onUpdate:currentPage":a[6]||(a[6]=e=>w.currentPage=e),"page-sizes":[5,10,20],"page-size":w.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:w.total},null,8,["onSizeChange","onCurrentChange","currentPage","page-size","total"])])])],64)}var w=l(4471);function k(e){const a=document.cookie;let l=a.indexOf(e);if(-1!==l){l=l+e.length+1;let s=a.indexOf(";",l);-1===s&&(s=a.length);var t=unescape(a.substring(l,s))}return t}var f={name:"Borrow",data(){return{user:{},userId:0,currentPage:1,pageSize:10,total:0,records:[],tableData:[],searchTitle:"",searchUsername:"",searchPhone:"",searchEmail:"",searchState:"",options:[{value:"待审核",label:"待审核"},{value:"借阅中",label:"借阅中"},{value:"已归还",label:"已归还"},{value:"未归还",label:"未归还"}]}},created(){this.user=JSON.parse(k("user")),this.load(),this.$nextTick((()=>{this.load()}))},methods:{load(){w.Z.get("/borrow",{params:{pageNum:this.currentPage,pageSize:this.pageSize,userId:this.user.id,searchTitle:this.searchTitle,searchUsername:this.searchUsername,searchPhone:this.searchPhone,searchEmail:this.searchEmail,searchState:this.searchState}}).then((e=>{console.log(e),this.tableData=e.data.records,this.total=e.data.total}))},reset(){this.searchTitle="",this.searchUsername="",this.searchPhone="",this.searchEmail=""},approve(e){w.Z.put("/borrow/approve",e).then((e=>{console.log(e),"0"===e.code?(this.$message({type:"success",message:"审核借阅通过！"}),this.dialogVisible=!1,this.load()):(this.$message({type:"error",message:e.msg}),this.dialogVisible=!1)}))},finish(e){w.Z.put("/borrow/finish",e).then((e=>{console.log(e),"0"===e.code?(this.$message({type:"success",message:"归还图书成功！"}),this.dialogVisible=!1,this.load()):(this.$message({type:"error",message:e.msg}),this.dialogVisible=!1)}))},drop(e){w.Z.put("/borrow/drop",e).then((e=>{console.log(e),"0"===e.code?(this.$message({type:"success",message:"设置图书丢失成功！"}),this.dialogVisible=!1,this.load()):(this.$message({type:"error",message:e.msg}),this.dialogVisible=!1)}))},currentChange(e){this.currentPage=e,this.load()},sizeChange(e){this.pageSize=e,this.load()}}},y=l(3744);const b=(0,y.Z)(f,[["render",g]]);var _=b}}]);
//# sourceMappingURL=707.94a0a690.js.map